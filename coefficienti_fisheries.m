addpath('data')
load('cella_temp');
load('D9') % matrice delle distanze

%% COEFFICENTI MOLTIPLICATIVI
% vari coefficienti moltiplicativi
load('fisheries_GSA_9')

% NON PESATO
cat_gns_625 = Q(1)* [0 0.2 1 0.59 0.56 0.39 0.12]; % GNS sbrana 625 SELECT
cat_gns_820 = Q(2)* [0 0  0.15 1 0.27 0 0]; % GNS sbrana 820 SECHIN
cat_otb_33 = Q(3)* [0.61 1 1 0.24 0 0 0]; % OTB sbrana + RB
cat_otb_40 = Q(4)* [0.49 1 1 0.60 0 0 0]; % OTB sbrana + RB

%kernel = 3; % 1 = power law, 2 = exponential, 3 = gaussian;

if exist('kernel') == 0;
    kernel = 3;
    modello = 1;
end

if kernel == 1;
    alfa_rit = Q(5); 
    beta_rit = Q(6);
    D9m = D9; % piazzo qualcosa nella diagonale
    D9m(1:(length(D9m)+1):end) = ones(length(D9m),1);
    D0 = (ones(size(D9))-eye(size(D9))).*(D9m.^(-beta_rit)) + alfa_rit*eye(size(D9));
elseif kernel == 2;
    beta_rit = Q(5);
    D0 = exp(-beta_rit*D9);
elseif kernel == 3;
    beta_rit = Q(5); 
    D0 = exp(- D9.^2 / beta_rit);
end

D0 = D0.*(repmat(persistenza_sg(limiti_regioni(4,1):end)', length(celle_o), 1)>0);
D = D0./repmat(sum(D0,2),1, length(D0));

eff_gns = [3121951.22	3902439.024	3121951.22	3278048.78	2731707.317	3746341.463	2107317.073	1404878.049	1482926.829];
eff_gns = eff_gns/(mean(eff_gns));
eff_otb = [12487804.9 12800000 10614634.2 12175609.8 11317073.2 10770731.7 9990243.9 10848780.5 11004878.1];
eff_otb = eff_otb/(mean(eff_otb));

catches_data = [23197.434	32439.19	35592.882	60804.151	11959.687	41216.305	12689.716	13083.162	30613.053
5961.151	7990.058	5751.982	6327.486	5038.45	5913.918	4275.239	7206.196	5584.203
1351.802	691.831	383.198	403.203	514.133	529.379	319.563	326.75	439.276
170.594	73.124	92.52	105.076	132.456	96.099	82.431	40.263	77.032
59.429	10.484	15.488	39.848	53.847	52.529	34.292	18.262	11.562
1.704	1.704	11.567	9.22	25.831	13.009	7.632	3.101	2.793
1.101	1.101	3.59	1.935	5.523	2.465	0.888	0.533	0.67]*1000;

catches_STECF = [26173.26464	37942.70269	41563.92181	73927.22142	13248.84143	49753.5938	14041.36464	14732.37025	35692.80797
6471.320569	8902.179376	6340.784512	6940.805972	5475.242882	6567.869824	4679.733977	7925.475022	6114.452272
1407.262985	715.8132549	394.2155861	419.0131633	530.6075169	548.1357492	329.4763321	335.8971494	451.4174103
175.7678254	74.39091104	95.13897325	106.8127342	136.2337939	98.35368955	84.80113836	40.9624591	77.65381241
61.81168296	10.37929606	16.07746837	40.99289795	54.73696678	54.94513814	34.30677658	19.22114335	12.1739544
1.762866449	1.689845421	11.66907255	8.458184652	26.27387893	13.22243613	7.885880017	2.989974029	2.381482549
1.11150841	1.094498493	3.619557056	1.783385933	5.613192413	2.494921045	0.894596221	0.516533003	0.574052074]*1000;

L_STECF_otb = [1179.96 1024.96 914.77 853.24 834.14 795.36 653.57 1044.30 1010.37];
L_STECF_gns = [592.57 576.22  345.23 401.26 576.26 502.08 309.33 199.21 177.73]; 

N_max = length(A_f);

area_pesca = nan(length(D),1);

for i = 1:length(celle_o);
area_pesca(i) =  sum(A_f.*(id_f == celle_o(i)).*(((P_otb_1224>0)+(P_otb_012>0)+(P_ssc_1224>0)+(P_ssc_012>0))>0)); 
end
%%